{"version":3,"file":"index.js","sources":["../../node_modules/.pnpm/serialize-javascript@6.0.1/node_modules/serialize-javascript/index.js","../../node_modules/.pnpm/randombytes@2.1.0/node_modules/randombytes/index.js","../../../packages/Response/statusCodes.ts","../../../packages/Response/index.ts"],"sourcesContent":["/*\nCopyright (c) 2014, Yahoo! Inc. All rights reserved.\nCopyrights licensed under the New BSD License.\nSee the accompanying LICENSE file for terms.\n*/\n\n'use strict';\n\nvar randomBytes = require('randombytes');\n\n// Generate an internal UID to make the regexp pattern harder to guess.\nvar UID_LENGTH          = 16;\nvar UID                 = generateUID();\nvar PLACE_HOLDER_REGEXP = new RegExp('(\\\\\\\\)?\"@__(F|R|D|M|S|A|U|I|B|L)-' + UID + '-(\\\\d+)__@\"', 'g');\n\nvar IS_NATIVE_CODE_REGEXP = /\\{\\s*\\[native code\\]\\s*\\}/g;\nvar IS_PURE_FUNCTION = /function.*?\\(/;\nvar IS_ARROW_FUNCTION = /.*?=>.*?/;\nvar UNSAFE_CHARS_REGEXP   = /[<>\\/\\u2028\\u2029]/g;\n\nvar RESERVED_SYMBOLS = ['*', 'async'];\n\n// Mapping of unsafe HTML and invalid JavaScript line terminator chars to their\n// Unicode char counterparts which are safe to use in JavaScript strings.\nvar ESCAPED_CHARS = {\n    '<'     : '\\\\u003C',\n    '>'     : '\\\\u003E',\n    '/'     : '\\\\u002F',\n    '\\u2028': '\\\\u2028',\n    '\\u2029': '\\\\u2029'\n};\n\nfunction escapeUnsafeChars(unsafeChar) {\n    return ESCAPED_CHARS[unsafeChar];\n}\n\nfunction generateUID() {\n    var bytes = randomBytes(UID_LENGTH);\n    var result = '';\n    for(var i=0; i<UID_LENGTH; ++i) {\n        result += bytes[i].toString(16);\n    }\n    return result;\n}\n\nfunction deleteFunctions(obj){\n    var functionKeys = [];\n    for (var key in obj) {\n        if (typeof obj[key] === \"function\") {\n            functionKeys.push(key);\n        }\n    }\n    for (var i = 0; i < functionKeys.length; i++) {\n        delete obj[functionKeys[i]];\n    }\n}\n\nmodule.exports = function serialize(obj, options) {\n    options || (options = {});\n\n    // Backwards-compatibility for `space` as the second argument.\n    if (typeof options === 'number' || typeof options === 'string') {\n        options = {space: options};\n    }\n\n    var functions = [];\n    var regexps   = [];\n    var dates     = [];\n    var maps      = [];\n    var sets      = [];\n    var arrays    = [];\n    var undefs    = [];\n    var infinities= [];\n    var bigInts = [];\n    var urls = [];\n\n    // Returns placeholders for functions and regexps (identified by index)\n    // which are later replaced by their string representation.\n    function replacer(key, value) {\n\n        // For nested function\n        if(options.ignoreFunction){\n            deleteFunctions(value);\n        }\n\n        if (!value && value !== undefined && value !== BigInt(0)) {\n            return value;\n        }\n\n        // If the value is an object w/ a toJSON method, toJSON is called before\n        // the replacer runs, so we use this[key] to get the non-toJSONed value.\n        var origValue = this[key];\n        var type = typeof origValue;\n\n        if (type === 'object') {\n            if(origValue instanceof RegExp) {\n                return '@__R-' + UID + '-' + (regexps.push(origValue) - 1) + '__@';\n            }\n\n            if(origValue instanceof Date) {\n                return '@__D-' + UID + '-' + (dates.push(origValue) - 1) + '__@';\n            }\n\n            if(origValue instanceof Map) {\n                return '@__M-' + UID + '-' + (maps.push(origValue) - 1) + '__@';\n            }\n\n            if(origValue instanceof Set) {\n                return '@__S-' + UID + '-' + (sets.push(origValue) - 1) + '__@';\n            }\n\n            if(origValue instanceof Array) {\n                var isSparse = origValue.filter(function(){return true}).length !== origValue.length;\n                if (isSparse) {\n                    return '@__A-' + UID + '-' + (arrays.push(origValue) - 1) + '__@';\n                }\n            }\n\n            if(origValue instanceof URL) {\n                return '@__L-' + UID + '-' + (urls.push(origValue) - 1) + '__@';\n            }\n        }\n\n        if (type === 'function') {\n            return '@__F-' + UID + '-' + (functions.push(origValue) - 1) + '__@';\n        }\n\n        if (type === 'undefined') {\n            return '@__U-' + UID + '-' + (undefs.push(origValue) - 1) + '__@';\n        }\n\n        if (type === 'number' && !isNaN(origValue) && !isFinite(origValue)) {\n            return '@__I-' + UID + '-' + (infinities.push(origValue) - 1) + '__@';\n        }\n\n        if (type === 'bigint') {\n            return '@__B-' + UID + '-' + (bigInts.push(origValue) - 1) + '__@';\n        }\n\n        return value;\n    }\n\n    function serializeFunc(fn) {\n      var serializedFn = fn.toString();\n      if (IS_NATIVE_CODE_REGEXP.test(serializedFn)) {\n          throw new TypeError('Serializing native function: ' + fn.name);\n      }\n\n      // pure functions, example: {key: function() {}}\n      if(IS_PURE_FUNCTION.test(serializedFn)) {\n          return serializedFn;\n      }\n\n      // arrow functions, example: arg1 => arg1+5\n      if(IS_ARROW_FUNCTION.test(serializedFn)) {\n          return serializedFn;\n      }\n\n      var argsStartsAt = serializedFn.indexOf('(');\n      var def = serializedFn.substr(0, argsStartsAt)\n        .trim()\n        .split(' ')\n        .filter(function(val) { return val.length > 0 });\n\n      var nonReservedSymbols = def.filter(function(val) {\n        return RESERVED_SYMBOLS.indexOf(val) === -1\n      });\n\n      // enhanced literal objects, example: {key() {}}\n      if(nonReservedSymbols.length > 0) {\n          return (def.indexOf('async') > -1 ? 'async ' : '') + 'function'\n            + (def.join('').indexOf('*') > -1 ? '*' : '')\n            + serializedFn.substr(argsStartsAt);\n      }\n\n      // arrow functions\n      return serializedFn;\n    }\n\n    // Check if the parameter is function\n    if (options.ignoreFunction && typeof obj === \"function\") {\n        obj = undefined;\n    }\n    // Protects against `JSON.stringify()` returning `undefined`, by serializing\n    // to the literal string: \"undefined\".\n    if (obj === undefined) {\n        return String(obj);\n    }\n\n    var str;\n\n    // Creates a JSON string representation of the value.\n    // NOTE: Node 0.12 goes into slow mode with extra JSON.stringify() args.\n    if (options.isJSON && !options.space) {\n        str = JSON.stringify(obj);\n    } else {\n        str = JSON.stringify(obj, options.isJSON ? null : replacer, options.space);\n    }\n\n    // Protects against `JSON.stringify()` returning `undefined`, by serializing\n    // to the literal string: \"undefined\".\n    if (typeof str !== 'string') {\n        return String(str);\n    }\n\n    // Replace unsafe HTML and invalid JavaScript line terminator chars with\n    // their safe Unicode char counterpart. This _must_ happen before the\n    // regexps and functions are serialized and added back to the string.\n    if (options.unsafe !== true) {\n        str = str.replace(UNSAFE_CHARS_REGEXP, escapeUnsafeChars);\n    }\n\n    if (functions.length === 0 && regexps.length === 0 && dates.length === 0 && maps.length === 0 && sets.length === 0 && arrays.length === 0 && undefs.length === 0 && infinities.length === 0 && bigInts.length === 0 && urls.length === 0) {\n        return str;\n    }\n\n    // Replaces all occurrences of function, regexp, date, map and set placeholders in the\n    // JSON string with their string representations. If the original value can\n    // not be found, then `undefined` is used.\n    return str.replace(PLACE_HOLDER_REGEXP, function (match, backSlash, type, valueIndex) {\n        // The placeholder may not be preceded by a backslash. This is to prevent\n        // replacing things like `\"a\\\"@__R-<UID>-0__@\"` and thus outputting\n        // invalid JS.\n        if (backSlash) {\n            return match;\n        }\n\n        if (type === 'D') {\n            return \"new Date(\\\"\" + dates[valueIndex].toISOString() + \"\\\")\";\n        }\n\n        if (type === 'R') {\n            return \"new RegExp(\" + serialize(regexps[valueIndex].source) + \", \\\"\" + regexps[valueIndex].flags + \"\\\")\";\n        }\n\n        if (type === 'M') {\n            return \"new Map(\" + serialize(Array.from(maps[valueIndex].entries()), options) + \")\";\n        }\n\n        if (type === 'S') {\n            return \"new Set(\" + serialize(Array.from(sets[valueIndex].values()), options) + \")\";\n        }\n\n        if (type === 'A') {\n            return \"Array.prototype.slice.call(\" + serialize(Object.assign({ length: arrays[valueIndex].length }, arrays[valueIndex]), options) + \")\";\n        }\n\n        if (type === 'U') {\n            return 'undefined'\n        }\n\n        if (type === 'I') {\n            return infinities[valueIndex];\n        }\n\n        if (type === 'B') {\n            return \"BigInt(\\\"\" + bigInts[valueIndex] + \"\\\")\";\n        }\n\n        if (type === 'L') {\n            return \"new URL(\\\"\" + urls[valueIndex].toString() + \"\\\")\"; \n        }\n\n        var fn = functions[valueIndex];\n\n        return serializeFunc(fn);\n    });\n}\n","module.exports = require('crypto').randomBytes\n",null,null],"names":["randomBytes","require$$0","UID_LENGTH","UID","bytes","result","i","toString","generateUID","PLACE_HOLDER_REGEXP","RegExp","IS_NATIVE_CODE_REGEXP","IS_PURE_FUNCTION","IS_ARROW_FUNCTION","UNSAFE_CHARS_REGEXP","RESERVED_SYMBOLS","ESCAPED_CHARS","escapeUnsafeChars","unsafeChar","StatusCodes","serializeJavascript","serialize","obj","options","space","str","functions","regexps","dates","maps","sets","arrays","undefs","infinities","bigInts","urls","ignoreFunction","undefined","String","isJSON","JSON","stringify","key","value","functionKeys","push","length","deleteFunctions","BigInt","origValue","this","type","Date","Map","Set","Array","filter","URL","isNaN","isFinite","unsafe","replace","match","backSlash","valueIndex","toISOString","source","flags","from","entries","values","Object","assign","fn","serializedFn","test","TypeError","name","argsStartsAt","indexOf","def","substr","trim","split","val","join","serializeFunc","defaultOptions","statusCode","contentType","resultResponseFabric","currentOptions","stringifiedResult","request","response","meta","setHeader","end","Response","Ok","Created","PartialContent","BadRequest","NotFound","InternalServerError","NotImplemented","Accepted","message","textResponseFabric"],"mappings":"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"}