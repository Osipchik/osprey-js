import e from"fs";import t from"path";import*as r from"os";import n from"os";import s from"http";import i from"@/utils/Logger/concollor";var o={},a={get exports(){return o},set exports(e){o=e}};const l=e,h=t,c=n,d={name:"dotenv",version:"16.0.3",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{require:"./lib/main.js",types:"./lib/main.d.ts",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^17.0.9",decache:"^4.6.1",dtslint:"^3.7.0",sinon:"^12.0.1",standard:"^16.0.4","standard-markdown":"^7.1.0","standard-version":"^9.3.2",tap:"^15.1.6",tar:"^6.1.11",typescript:"^4.5.4"},engines:{node:">=12"}}.version,u=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function p(e){console.log(`[dotenv@${d}][DEBUG] ${e}`)}const m={config:function(e){let t=h.resolve(process.cwd(),".env"),r="utf8";const n=Boolean(e&&e.debug),s=Boolean(e&&e.override);var i;e&&(null!=e.path&&(t="~"===(i=e.path)[0]?h.join(c.homedir(),i.slice(1)):i),null!=e.encoding&&(r=e.encoding));try{const e=m.parse(l.readFileSync(t,{encoding:r}));return Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(process.env,t)?(!0===s&&(process.env[t]=e[t]),n&&p(!0===s?`"${t}" is already defined in \`process.env\` and WAS overwritten`:`"${t}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[t]=e[t]})),{parsed:e}}catch(e){return n&&p(`Failed to load ${t} ${e.message}`),{error:e}}},parse:function(e){const t={};let r,n=e.toString();for(n=n.replace(/\r\n?/gm,"\n");null!=(r=u.exec(n));){const e=r[1];let n=r[2]||"";n=n.trim();const s=n[0];n=n.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===s&&(n=n.replace(/\\n/g,"\n"),n=n.replace(/\\r/g,"\r")),t[e]=n}return t}};var f=o.config=m.config;o.parse=m.parse,a.exports=m;var g,w={},v={};Object.defineProperty(v,"__esModule",{value:!0}),function(e){e[e.STATIC=0]="STATIC",e[e.PARAM=1]="PARAM"}(g||(g={}));const C=":",E="/".charCodeAt(0);class b{constructor(e={}){this.indices=e.indices||"",this.children=e.children||[],this.childrenI=e.childrenI||{},this.path=e.path||"",this.handle=e.handle||null,this.wildChild=e.wildChild||!1,this.type=e.type||g.STATIC,this.param=e.param||"",this.pathLength=this.path.length,this.childrenLength=this.children.length}addRoute(e,t){const r=this.countParams(e);this.isEmpty()?this.insertChild(e,e,t,r):this.onChunk(this,e,e,t,r)}search(e){let t=this;const r={};e:for(;;){const n=e.length;if(n>t.pathLength&&e.slice(0,t.pathLength)===t.path){if(e=e.slice(t.pathLength),t.wildChild){t=t.children[0];let s=0;for(;s<n&&e.charCodeAt(s)!==E;)s++;const i=e.slice(0,s);if(!i||!t.param)return{value:null,params:r};if("!"!==t.param&&(r[t.param]=i),s<n){if(0===t.childrenLength)return{value:null,params:r};e=e.slice(s),t=t.children[0];continue e}return{value:t.handle,params:r}}const s=e.charCodeAt(0);for(let e=0;e<t.indices.length;e++)if(s===t.indices.charCodeAt(e)){t=t.children[e];continue e}}else if(e===t.path)return{value:t.handle,params:r};return{value:null,params:r}}}hasChildren(){return this.children.length>0}insertChild(e,t,r,n){let s=0,i=this;for(let r=0,o=t.length;n>0;r++){if(t[r]!==C)continue;let a=r+1;for(;a<o&&"/"!==t[a];){if(t[a]===C)throw new Error("only one wildcard per path segment is allowed, has: '"+t.slice(r)+"' in path '"+e+"'");a++}if(i.hasChildren())throw new Error("wildcard route '"+t.slice(r,a)+"' conflicts with existing children in path '"+e+"'");if(a-r<2)throw new Error("wildcards must be named with a non-empty name in path '"+e+"'");r>0&&(i.replacePath(t.slice(s,r)),s=r),i=i.replaceChildren({type:g.PARAM}),n--,a<o&&(i.replacePath(t.slice(s,a)),s=a,i=i.replaceChildren())}i.replacePath(t.slice(s)),i.setHandle(r)}setHandle(e){this.handle=e}replaceChildren(e={}){const t=new b(e);return e.type===g.PARAM&&(this.wildChild=!0),this.children=[t],this.childrenLength=1,t}replacePath(e){e[0]===C&&(this.param=e.slice(1)),this.path=e,this.pathLength=e.length}isEmpty(){return!(this.path.length>0||this.children.length>0)}processCharacter(e,t,r,n){const s=t[0];if(this.type===g.PARAM&&"/"===s&&1===this.children.length)return void this.onChunk(this.children[0],e,t,r,n);const i=this.childrenI[s.charCodeAt(0)];if(i)i.onChunk(i,e,t,r,n);else{if(s!==C){const i=new b({type:g.STATIC});return this.children.push(i),this.indices+=s,this.childrenI[s.charCodeAt(0)]=i,this.childrenLength=this.children.length,void i.insertChild(e,t,r,n)}this.insertChild(e,t,r,n)}}processWildcard(e,t,r,n){if(t.length>=this.path.length&&this.path===t.slice(0,this.path.length)&&(this.path.length>=t.length||"/"===t[this.path.length]))return void this.onChunk(this,e,t,r,n);const s=t.split("/")[0],i=e.slice(0,e.indexOf(s))+this.path;throw new Error(`'${s}' in new path '${e}' conflicts with existing wildcard '${this.path}' in existing prefix '${i}'`)}createNode(e,t,r,n,s){const i=r.slice(e);this.wildChild?this.children[0].processWildcard(t,i,n,s-1):this.processCharacter(t,i,n,s)}commonPrefixIndex(e){let t=0;const r=Math.min(e.length,this.path.length);for(;t<r&&this.path[t]===e[t];)t++;return t}split(e,t){if(e<this.path.length){const r=new b({path:this.path.slice(e),wildChild:this.wildChild,childrenI:this.childrenI,children:this.children,handle:this.handle,indices:this.indices});return this.children=[r],this.indices=this.path[e],this.childrenI={[this.indices.charCodeAt(0)]:r},this.childrenLength=1,this.wildChild=!1,this.path=t.slice(0,e),this.pathLength=this.path.length,this.handle=null,!0}return!1}onChunk(e,t,r,n,s){const i=e.commonPrefixIndex(r),o=e.split(i,r);if(i<r.length)e.createNode(i,t,r,n,s);else if(i===r.length){if(!o)throw new Error("Route already defined.");this.handle=n}}countParams(e){let t=0;for(let r=0;r<e.length;r++)e[r]===C&&t++;return t}}v.Node=b,Object.defineProperty(w,"__esModule",{value:!0});const T=v;function y(e,t){if(!t)throw new Error("Path is required.");if(!e)throw new Error("Bucket is required.");if("string"!=typeof e)throw new Error("Bucket should be a string.");if("string"!=typeof t)throw new Error("Path should be a string.")}var A=w.RoadRunner=class{constructor(){this.buckets={}}addRoute(e,t,r){if(y(e,t),"/"!==t[0]&&"*"!==t[0])throw new Error("The first character of a path should be `/` or `*`.");t=t.replace(/\*([A-z0-9]+)?\//g,":!/").replace(/\*$/g,":!"),this.buckets[e]||(this.buckets[e]=new T.Node),this.buckets[e].addRoute(t,r)}findRoute(e,t){if(y(e,t),!this.buckets[e])return null;const r=this.buckets[e].search(t);return null===r.value?null:{value:r.value,params:r.params}}};const S={b:1,f:2,i:3,u:4,l:5,h:6,n:7,c:8,s:9},N=["black","red","green","yellow","blue","magenta","cyan","white","crimson"];function $(e,t){return e?`[${e}m${t}[0m`:t}function P(e,t){for(const r of e.split(","))if(1===r.length)t=$(S[r],t);else{const[e,n]=r.split("/"),s=N.indexOf(e),i=N.indexOf(n);s>-1&&(t=$(30+s,t)),i>-1&&(t=$(40+i,t))}return t}function x(e){return(t,...r)=>{if("string"==typeof t)return P(e,t);const n=[t[0]];let s=1;for(const e of r){const r=t[s++];n.push(String(e),r)}return P(e,n.join(""))}}module.exports=P,module.exports=x;const I={titleTag:x("b,i,red/red"),messageTag:x("red/red"),defaultTitle:"Error"},k={titleTag:x("b,i,yellow/yellow"),messageTag:x("yellow/yellow"),defaultTitle:"Warn"},M={titleTag:x("b,blue"),messageTag:x("blue"),defaultTitle:"Info"},R={titleTag:x("b,green"),messageTag:x("green"),defaultTitle:"Success"},j={titleTag:x("b,cyan"),messageTag:x("cyan"),defaultTitle:"Put"},L={titleTag:x("b,crimson"),messageTag:x("crimson"),defaultTitle:"Patch"},O={titleTag:x("b,magenta"),messageTag:x("magenta"),defaultTitle:"Data"},q=/(https?:\/\/\S+)/gm;function H(e){const t=String(e);console.log(t.replace(q,(e=>i`${e}(u,blue)`)))}function F({titleTag:e,messageTag:t,defaultTitle:r}){return function(n,s){console.log(e(`${s??r}: `)+t(`${n}`))}}var D;function U(e,t){const r=`The request method: ${e.method} is not supported by the server and cannot be handled`;H.error(r,`Error ${D.NotImplemented}`),t.statusCode=D.NotImplemented,t.statusMessage=r,t.end()}function B(e,t,r){H.error("Unexpected Server Error",`Error ${D.InternalServerError}`),H.error(r.message),t.statusCode=D.InternalServerError,t.statusMessage="Internal Server Error",t.end()}function W(e,t){const r=`The request ${e.method} ${e.url} is not allowed`;t.statusCode=D.MethodNotAllowed,t.statusMessage=r,t.end()}function _(e,t){const r=`The request ${e.method} ${e.url} is not found`;t.statusCode=D.NotFound,t.statusMessage=r,t.end()}function z(e){let t=e;for(;t.startsWith("/");)t=t.slice(1);for(;t.endsWith("/");)t=t.slice(0,-1);return"/"+t}function G(e,t){const r=e??"",n=t??"";if(r.includes(":"))throw new Error("cant has semicolon");if(n.includes("*"))throw new Error("cant has semicolon");const s=[],i=n.split("/").reduce(((e,t)=>{if(t.includes(":")){const r=t.slice(1);if(!function(e){if(e.trim()!==e)return!1;try{new Function(e,"var "+e)}catch(e){return!1}return!0}(r))throw new Error(`invalid var name: ${r}`);return s.push(t.slice(1)),e+"/"+t}return e+"/"+t}),""),o=z(r);return{pathName:z(o+z(i)),prefix:o,props:s}}H.error=F(I),H.warn=F(k),H.info=F(M),H.success=F(R),H.put=F(j),H.patch=F(L),H.data=F(O),module.exports=H,function(e){e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.IMUsed=226]="IMUsed",e[e.BadRequest=400]="BadRequest",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented"}(D||(D={})),module.exports=U,module.exports=B,module.exports=W,module.exports=_;class V{static ServerError=B;static NotFound=_;static MethodNotAllowed=W;static NotImplemented=U;static router=new A;static routeHandlers={GET:{},HEAD:{},POST:{},PUT:{},DELETE:{},CONNECTS:{},OPTIONS:{},TRACE:{},PATCH:{},ServerError:V.ServerError,NotFound:V.NotFound,MethodNotAllowed:V.MethodNotAllowed,NotImplemented:V.NotImplemented};static addRoute(e,{method:t,prefix:r,path:n}){const{pathName:s}=G(r,n);switch(t){case"GET":H.info(s,t);break;case"POST":H.warn(s,t);break;case"DELETE":H.error(s,t);break;case"PATCH":H.patch(s,t);break;case"PUT":H.put(s,t);break;default:H.data(s,t)}V.router.addRoute(t,s,e)}getRequestHandler(e){if(e.method){const t=V.router.findRoute(e.method,e.url);return t?{handler:t.value,params:t.params}:{handler:V.routeHandlers.NotFound}}return{handler:V.routeHandlers.NotImplemented}}}module.exports=V;class Z{static middlewares=[];static asyncMiddlewares=[];runMiddlewaresSync(e,t){const r=e=>{if(e instanceof Error)throw t=e.message,r="Middleware",H.error(t,`Middleware Error in ${r}`),new Error(t);var t,r};for(const n of Z.middlewares)n(e,t,r)}static use(e){Z.middlewares.push(e)}}module.exports=Z;class J{server;middleware;router;host;port;constructor(){this.requestListener=this.requestListener.bind(this),this.middleware=new Z,this.router=new V,this.server=s.createServer(this.requestListener),this.host=process.env.HOST||"localhost",this.port=Number(process.env.PORT)||3e3}requestListener(e,t){try{this.middleware.runMiddlewaresSync(e,t);const{handler:r,params:n}=this.router.getRequestHandler(e);r(e,t,n)}catch(r){V.routeHandlers.ServerError(e,t,r)}}run(){this.server.on("error",(e=>{"EACCES"===e.code&&H.error(`No access to port: ${this.port}`,"EACCES")})),this.server.listen(this.port,(()=>{H.success(`Server is running at http://${this.host}:${this.port}`)})),process.on("exit",(()=>{this.server.close((()=>{H.warn(`Server is closed at http://${this.host}:${this.port}`)}))})),process.on("exit",(()=>{this.server.close((()=>{H.warn(`Server is closed at http://${this.host}:${this.port}`)}))}))}}module.exports=J,f();const K=r.cpus().length;class Q{threadPoolSize;constructor(e={}){this.threadPoolSize=function(e){if(e<1)throw new Error("application can't using less then 1 CPU core");if(e>K)throw new Error(`application can't using more then ${K} CPU core`);return process.env.UV_THREADPOOL_SIZE=String(e),e}(e.threadPoolSize??K)}useControllers(e){const t=[];for(const r of e)t.push(new r)}run(){(new J).run()}}module.exports=Q;export{Q as default};
//# sourceMappingURL=index.js.map
